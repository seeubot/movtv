<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Media Manager</title>
  <link href="https://vjs.zencdn.net/7.17.0/video-js.css" rel="stylesheet" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #121212;
      color: #ffffff;
    }

    header {
      background-color: #1e1e1e;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header input[type="search"] {
      padding: 8px;
      width: 60%;
      border: 1px solid #333;
      border-radius: 4px;
      outline: none;
      font-size: 16px;
    }

    header input[type="search"]:focus {
      border-color: #fff;
    }

    main {
      padding: 20px;
    }

    h2 {
      margin-top: 20px;
    }

    .movie-list, .series-list {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .movie-item, .series-item {
      background-color: #2e2e2e;
      border: 1px solid #333;
      border-radius: 8px;
      overflow: hidden;
      width: 200px;
      text-align: center;
      padding: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .movie-item:focus, .series-item:focus {
      transform: scale(1.05);
      outline: none;
    }

    .movie-item img, .series-item img {
      width: 100%;
      height: auto;
    }

    .movie-item h3, .series-item h3 {
      margin: 10px 0 5px;
      font-size: 18px;
    }

    .movie-item p, .series-item p {
      margin: 0;
      font-size: 14px;
      color: #aaa;
    }

    .video-js {
      width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <header>
    <h1>Media Manager</h1>
    <input type="search" id="search" placeholder="Search for movies and series..." aria-label="Search">
  </header>
  <main>
    <section id="movies">
      <h2>Movies</h2>
      <div class="movie-list" id="movie-list">
        <!-- Movies will be dynamically inserted here -->
      </div>
    </section>
    <section id="series">
      <h2>Series</h2>
      <div class="series-list" id="series-list">
        <!-- Series will be dynamically inserted here -->
      </div>
    </section>
  </main>
  <div id="video-player" class="video-js vjs-default-skin" controls>
    <video class="video-js__player" controls preload="auto" width="640" height="264">
      <source src="" type="video/mp4">
    </video>
  </div>
  <script src="https://vjs.zencdn.net/7.17.0/video.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const searchInput = document.getElementById('search');
      const movieList = document.getElementById('movie-list');
      const seriesList = document.getElementById('series-list');
      const videoPlayer = document.getElementById('video-player');
      const videoJsPlayer = videojs(videoPlayer);

      searchInput.addEventListener('input', debounce(searchContent, 300));

      function debounce(func, delay) {
        let debounceTimer;
        return function() {
          const context = this;
          const args = arguments;
          clearTimeout(debounceTimer);
          debounceTimer = setTimeout(() => func.apply(context, args), delay);
        };
      }

      async function searchContent() {
        const query = searchInput.value.trim();
        if (query) {
          const movies = await fetchMovies(query);
          const series = await fetchSeries(query);
          displayMovies(movies);
          displaySeries(series);
        } else {
          displayMovies(await fetchMovies());
          displaySeries(await fetchSeries());
        }
      }

      async function fetchMovies(query = '') {
        const response = await fetch(`/api/movies?search=${query}`);
        return await response.json();
      }

      async function fetchSeries(query = '') {
        const response = await fetch(`/api/series?search=${query}`);
        return await response.json();
      }

      function displayMovies(movies) {
        movieList.innerHTML = '';
        movies.forEach(movie => {
          const movieItem = document.createElement('div');
          movieItem.className = 'movie-item';
          movieItem.tabIndex = 0;
          movieItem.innerHTML = `
            <img src="${movie.thumbnail}" alt="${movie.name}">
            <h3>${movie.name}</h3>
            <p>Added by: ${movie.addedBy}</p>
          `;
          movieItem.addEventListener('click', () => playMovie(movie.streamingUrl));
          movieItem.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
              playMovie(movie.streamingUrl);
            }
          });
          movieList.appendChild(movieItem);
        });
      }

      function displaySeries(series) {
        seriesList.innerHTML = '';
        series.forEach(seriesItem => {
          const seriesDiv = document.createElement('div');
          seriesDiv.className = 'series-item';
          seriesDiv.tabIndex = 0;
          seriesDiv.innerHTML = `
            <img src="${seriesItem.thumbnail}" alt="${seriesItem.name}">
            <h3>${seriesItem.name}</h3>
            <p>Added by: ${seriesItem.addedBy}</p>
          `;
          seriesDiv.addEventListener('click', () => playSeries(seriesItem._id));
          seriesDiv.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
              playSeries(seriesItem._id);
            }
          });
          seriesList.appendChild(seriesDiv);
        });
      }

      function playMovie(url) {
        videoJsPlayer.src({ src: url, type: 'video/mp4' });
        videoJsPlayer.play();
      }

      function playSeries(id) {
        // Implement series player logic here
        console.log('Playing series:', id);
      }

      // Initial load
      searchContent();
    });
  </script>
</body>
</html>
